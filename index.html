<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chennai Renegades - Room Allocation</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { margin: 0; padding: 0; font-family: system-ui, -apple-system, sans-serif; }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script>
        const { useState, useEffect } = React;
        const { createRoot } = ReactDOM;

        const storage = {
            get: (key) => {
                const val = localStorage.getItem('shared_' + key);
                return val ? JSON.parse(val) : null;
            },
            set: (key, value) => {
                localStorage.setItem('shared_' + key, JSON.stringify(value));
            }
        };

        function App() {
            const [riders, setRiders] = useState([]);
            const [currentRider, setCurrentRider] = useState('');
            const [spinning, setSpinning] = useState(false);
            const [currentIndex, setCurrentIndex] = useState(1);
            const [lastResult, setLastResult] = useState(null);
            const [isAdmin, setIsAdmin] = useState(false);
            const [password, setPassword] = useState('');
            const [rooms, setRooms] = useState({
                single: { total: 3, allocated: [] },
                double: { total: 7, allocated: [] },
                five: { total: 2, allocated: [] }
            });

            useEffect(() => {
                const saved = storage.get('riders') || Array.from({ length: 27 }, (_, i) => 'Rider ' + (i + 1));
                const savedRooms = storage.get('rooms');
                setRiders(saved);
                if (savedRooms) setRooms(savedRooms);
            }, []);

            const roomTypes = [
                { name: 'Private Suite', type: 'single', color: 'from-purple-500 to-purple-700', icon: 'ðŸ ', capacity: 1 },
                { name: 'Apartment', type: 'double', color: 'from-blue-500 to-blue-700', icon: 'ðŸ¢', capacity: 2 },
                { name: 'Villa', type: 'five', color: 'from-orange-500 to-orange-700', icon: 'ðŸ¡', capacity: 5 }
            ];

            const spin = () => {
                if (!currentRider || spinning) return;

                const available = [];
                if (rooms.single.allocated.length < rooms.single.total) available.push(0);
                if (rooms.double.allocated.length < rooms.double.total * 2) available.push(1);
                if (rooms.five.allocated.length < rooms.five.total * 5) available.push(2);

                if (available.length === 0) return;

                setSpinning(true);
                setLastResult(null);

                const target = available[Math.floor(Math.random() * available.length)];
                let count = 0;
                const spins = 15 + Math.floor(Math.random() * 10);

                const interval = setInterval(() => {
                    setCurrentIndex(p => (p + 1) % 3);
                    count++;

                    if (count >= spins) {
                        clearInterval(interval);
                        setCurrentIndex(target);

                        setTimeout(() => {
                            const selected = roomTypes[target];
                            const newRiders = riders.filter(r => r !== currentRider);
                            const newRooms = { ...rooms };
                            newRooms[selected.type].allocated.push(currentRider);

                            setRiders(newRiders);
                            setRooms(newRooms);
                            setLastResult({ rider: currentRider, room: selected.name });
                            setCurrentRider('');
                            setSpinning(false);

                            storage.set('riders', newRiders);
                            storage.set('rooms', newRooms);
                        }, 500);
                    }
                }, 100);
            };

            const reset = () => {
                const newRiders = Array.from({ length: 27 }, (_, i) => 'Rider ' + (i + 1));
                const newRooms = { single: { total: 3, allocated: [] }, double: { total: 7, allocated: [] }, five: { total: 2, allocated: [] } };
                setRiders(newRiders);
                setRooms(newRooms);
                setCurrentRider('');
                setLastResult(null);
                storage.set('riders', newRiders);
                storage.set('rooms', newRooms);
            };

            const getVisible = () => {
                const prev = (currentIndex - 1 + 3) % 3;
                const next = (currentIndex + 1) % 3;
                return [prev, currentIndex, next];
            };

            const login = () => {
                if (password === 'Ananth,@2025#') {
                    setIsAdmin(true);
                    setPassword('');
                } else {
                    alert('Incorrect password');
                    setPassword('');
                }
            };

            if (!isAdmin) {
                return React.createElement('div', { className: 'min-h-screen bg-gradient-to-br from-slate-900 via-blue-900 to-slate-900 p-6' },
                    React.createElement('div', { className: 'max-w-6xl mx-auto' },
                        React.createElement('div', { className: 'text-center mb-8' },
                            React.createElement('div', { className: 'flex items-center justify-center gap-4 mb-4' },
                                React.createElement('img', { src: 'https://chennairenegades.com/wp-content/uploads/2025/11/logo.jpg', alt: 'Chennai Renegades', className: 'w-24 h-24 rounded-full border-4 border-yellow-400 shadow-lg' }),
                                React.createElement('div', null,
                                    React.createElement('h1', { className: 'text-4xl font-bold text-yellow-400 mb-1' }, 'Chennai Renegades'),
                                    React.createElement('p', { className: 'text-2xl font-bold text-white' }, 'Hello Boys, Let\'s go for a spin!!!!')
                                )
                            )
                        ),
                        React.createElement('div', { className: 'grid lg:grid-cols-2 gap-6' },
                            React.createElement('div', { className: 'bg-white/10 backdrop-blur-lg rounded-2xl p-6 shadow-2xl border border-white/20' },
                                React.createElement('div', { className: 'relative mb-6' },
                                    React.createElement('div', { className: 'flex items-center justify-center gap-4 py-8' },
                                        getVisible().map((idx, pos) => {
                                            const room = roomTypes[idx];
                                            const isCenter = pos === 1;
                                            return React.createElement('div', { key: idx, className: 'transition-all duration-300 ' + (isCenter ? 'scale-110 opacity-100' : 'scale-75 opacity-40') },
                                                React.createElement('div', { className: 'bg-gradient-to-br ' + room.color + ' rounded-2xl p-8 shadow-2xl border-4 border-white min-w-[200px]' },
                                                    React.createElement('div', { className: 'text-center' },
                                                        React.createElement('div', { className: 'text-7xl mb-4' }, room.icon),
                                                        React.createElement('h3', { className: 'text-2xl font-bold text-white mb-2' }, room.name),
                                                        React.createElement('div', { className: 'text-sm text-white/80' }, room.capacity + (room.capacity > 1 ? ' Persons' : ' Person'))
                                                    )
                                                )
                                            );
                                        })
                                    ),
                                    React.createElement('div', { className: 'absolute top-0 left-1/2 -translate-x-1/2 -translate-y-4' },
                                        React.createElement('div', { className: 'w-0 h-0 border-l-[20px] border-r-[20px] border-t-[30px] border-l-transparent
